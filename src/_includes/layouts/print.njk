{% extends "layouts/print-frame.njk" %}


{% block content %}

    {%- if pagedjsCLI != true %}
    <div class="front-cover bleed">
        <div class="full-page-image">
            {% image ["LTLM45-2022-cover-front-", locale, "-v20220209a.jpg"] | join %}
        </div>
    </div>

    </div>
    <div class="front-collage bleed">
        {% image "front-photos-bleed.jpg" %}
    </div>
    <div class="opening-page">
        {% image "zen-circle.jpg" %}
    </div>
    {%- endif %}

    {%- for article in articles -%}
        {% set title = article.data.title %}
        {% set author = article.data.author %}
        {% set content = article.data.content %}
        {% set fileSlug = article.fileSlug %}
        <article>
            {% set artCall = articleCalligraphies(fileSlug, "articleCalligraphy") %}
            {%- if artCall.hasCalligraphy %}
                <h1 id="{{ title | slugify }}" class="chapter calligraphyTitle">
                    <img class="articleCalligraphy" src="{{ artCall.calligraphyFile }}">
                {# {% image artCall.calligraphyFile, "articleCalligraphy" %} #}
                </h1>
            {%- else %}
                <h1 id="{{ title | slugify }}" class="chapter">{{ title }}</h1>
            {%- endif %}

            <h2 class="author">{{ author }}</h2>
            {%- if pathPrefix != "" %}
                {{ content | safe | replace("/media/", pathPrefix+"/media/") }}
            {%- else %}
                {{ content | safe }}
            {%- endif %}
            <div class="article-end"></div>
        </article>
    {%- endfor -%}

    <div id="table-of-contents">
        <h1>{{ i18n.toc }}</h1>
        <ul class="toc">
            {%- for article in articles -%}
                <li><a class="toc-links" href="#{{ article.data.title | slugify }}">
                    <span class="toc-title">{{ article.data.title }}</span><br/>
                    <span class="toc-author">{{ article.data.author }}</span>
                </a></li>
            {%- endfor -%}
        </ul>
    </div>

    {%- if pagedjsCLI != true %}
    <div class="back-collage bleed">
        {% image "back-photos-bleed.jpg" %}
    </div>
    <div class="back-cover bleed">
        <div class="full-page-image">
                {% image ["LTLM45-2022-cover-back-", locale, "-v20220209a.jpg"] | join %}
        </div>
    </div>
    {%- endif %}

    {# {% include "partials/testing.njk" %} #}
{% endblock %}
